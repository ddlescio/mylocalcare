{% extends "layout_admin.html" %}
{% set body_class = "offset-navbar" %}

{% block admin_content %}
<div class="max-w-3xl mx-auto">

  <div class="bg-white border border-slate-200 rounded-2xl shadow-sm p-6">

    <!-- HEADER -->
    <div class="flex items-center justify-between mb-6">
      <div>
        <h1 class="text-2xl font-bold text-slate-900">
          {% if piano %}‚úèÔ∏è Modifica piano{% else %}‚ûï Nuovo piano{% endif %}
          ‚Äì {{ pacchetto.nome }}
        </h1>
        <p class="text-slate-600 text-sm mt-1">
          Configura durata e prezzo acquistabili dagli utenti
        </p>
      </div>

      <a href="{{ url_for('admin_pacchetti_piani', pacchetto_id=pacchetto.id) }}"
         class="px-4 py-2 rounded-xl bg-slate-100 text-slate-700 hover:bg-slate-200">
        ‚Üê Piani
      </a>
    </div>

    <form method="POST" class="space-y-6">

      <!-- CODICE -->
      <div>
        <label class="text-sm font-semibold">Codice piano</label>
        <input name="codice" required
               value="{{ piano.codice if piano else '' }}"
               class="mt-1 w-full px-3 py-2 rounded-xl border">
        <p class="text-xs text-slate-500 mt-1">
          Unico per questo pacchetto (es. BASE_30, PRO_90)
        </p>
      </div>

      <!-- NOME -->
      <div>
        <label class="text-sm font-semibold">Nome</label>
        <input name="nome" required
               value="{{ piano.nome if piano else '' }}"
               class="mt-1 w-full px-3 py-2 rounded-xl border">
      </div>

      <!-- DESCRIZIONE -->
      <div>
        <label class="text-sm font-semibold">Descrizione</label>
        <textarea name="descrizione" rows="3"
                  class="mt-1 w-full px-3 py-2 rounded-xl border">{{ piano.descrizione if piano else '' }}</textarea>
      </div>

      <!-- DURATA -->
      <div>
        <label class="text-sm font-semibold block mb-1">Durata</label>

        <div class="flex items-center gap-3">
          <input type="number"
                 name="durata_giorni"
                 min="1"
                 placeholder="Giorni"
                 value="{{ piano.durata_giorni if piano and piano.durata_giorni else '' }}"
                 class="w-32 px-3 py-2 rounded-xl border">

          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox"
                   name="permanente"
                   {% if piano and piano.durata_giorni is none %}checked{% endif %}>
            Permanente
          </label>
        </div>

        <p class="text-xs text-slate-500 mt-1">
          Se permanente, la durata viene ignorata
        </p>
      </div>

      <!-- PREZZO -->
      <div>
        <label class="text-sm font-semibold">Prezzo (‚Ç¨)</label>
        <input name="prezzo_euro"
               required
               inputmode="decimal"
               placeholder="0,00"
               value="{% if piano %}{{ '%.2f'|format(piano.prezzo_cent / 100) }}{% endif %}"
               class="mt-1 w-40 px-3 py-2 rounded-xl border">
      </div>

      <!-- ORDINE -->
      <div>
        <label class="text-sm font-semibold">Ordine visualizzazione</label>
        <input type="number"
               name="ordine"
               min="1"
               value="{{ piano.ordine if piano else 1 }}"
               class="mt-1 w-24 px-3 py-2 rounded-xl border">
      </div>

      <!-- FLAG -->
      <div class="flex flex-wrap gap-6 pt-2">

        <label class="flex items-center gap-2">
          <input type="checkbox" name="consigliato"
                 {% if piano and piano.consigliato %}checked{% endif %}>
          ‚≠ê Consigliato
        </label>

        <label class="flex items-center gap-2">
          <input type="checkbox" name="evidenziato"
                 {% if piano and piano.evidenziato %}checked{% endif %}>
          üçø Evidenziato
        </label>

        <label class="flex items-center gap-2">
          <input type="checkbox" name="attivo"
                 {% if piano is none or piano.attivo %}checked{% endif %}>
          Attivo
        </label>

      </div>

      <!-- AZIONI -->
      <div class="flex gap-2 pt-6">
        <button class="px-4 py-2 bg-emerald-600 text-white rounded-xl">
          Salva piano
        </button>

        <a href="{{ url_for('admin_pacchetti_piani', pacchetto_id=pacchetto.id) }}"
           class="px-4 py-2 bg-slate-100 rounded-xl">
          Annulla
        </a>
      </div>

    </form>
  </div>
</div>
{% endblock %}
